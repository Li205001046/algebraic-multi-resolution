%%%%%%%%%%%%%%%%%%%%%%%
%%% a layered model, Grid: 16*16*42 
%%% Comparison of responses from SG, and MRS with the analytic solution
%%%%%%%%%%%%%%%%%%%%%%%
clc
clear all
x=logspace(0,4,40);

%%% analytic solution
R=[8.06117631347401	8.11770070293338	8.53040103504624	9.35979312034053	10.6664393996144	12.5180505130637	14.9906672847144	18.1619551121857	22.0928494293650	26.7919441022018	32.1579890867485	37.9054851080742	43.5035824388646	48.1940491962184	51.1589204628452	51.8201956816711	50.1013660018675	46.4490888497576	41.6032921751741	36.3032583188386	31.1041356184170	26.3360080080071	22.1464882038002	18.5647382949655	15.5552373977695	13.0536459378846	10.9875614712851	9.28716863532673	7.88992538313720	6.74202900098290	5.79828673157487	5.02128703087716	4.38033760393027	3.85039743911201	3.41110289351136	3.04592290447574	2.74144687724716	2.48679477199032	2.27313376762021	2.09328505294575]; 
P=[40.2422935497166	36.6178027061965	32.6899556202986	28.8885690933740	25.5753185840087	22.9952834979585	21.2843465818037	20.5049005941399	20.6820410738977	21.8260425176461	23.9375305195187	26.9962389844033	30.9368704850577	35.6207734366739	40.8198490079417	46.2313792200659	51.5286400148202	56.4266509339831	60.7298641591522	64.3435560825592	67.2556773924449	69.5074060992024	71.1665115589802	72.3089623126791	73.0084708968046	73.3316710213470	73.3366610970731	73.0733013802911	72.5842799742587	71.9064014272705	71.0718179523432	70.1090734551747	69.0439123590044	67.8998498560318	66.6985254445779	65.4598763826480	64.2021758658085	62.9419836546628	61.6940550009810	60.4712476151031];

%%% SG
r=[8.01494359371674	8.14859824241424	8.65139608698134	9.58516313826156	11.0137873701720	13.0092252272610	15.6508428225614	19.0152393705936	23.1515050372346	28.0355613155012	33.5017546931224	39.1685582814053	44.4108034523686	48.4542957513352	50.6133588529980	50.5537766631646	48.4023398596779	44.6504278359193	39.9482925800163	34.9090595418386	29.9923506231958	25.4777543085344	21.4953942295147	18.0744629058078	15.1863928658583	12.7752301028093	10.7761243807106	9.12533169621440	7.76493020107540	6.64453599920227	5.72145165971671	4.96007678258414	4.33103262049131	3.81023284681484	3.37801036547554	3.01834481750534	2.71820212456308	2.46698146902235	2.25605836120343	2.07841039549267];
p=[39.3938633172237	35.6687791915775	31.7317549876468	28.0077250759196	24.8394322059745	22.4509755576638	20.9636833066418	20.4337629774806	20.8855174581596	22.3279131984130	24.7518125476405	28.1102628240449	32.2905100317975	37.0956427559152	42.2564998785139	47.4765980826510	52.4849572524303	57.0699766691595	61.0918886313805	64.4819920836123	67.2314375830953	69.3730778108846	70.9629532959484	72.0659742952069	72.7468859234512	73.0655762559439	73.0752767659113	72.8224229592879	72.3473332630806	71.6851951200795	70.8670731568405	69.9207934084159	68.8716391847353	67.7428419156421	66.5558789592141	65.3306079620701	64.0852776779021	62.8364595229039	61.5989432544687	60.3856347913538];

%%% MRS
r2=[8.01494359371674	8.14859824241424	8.65139608698134	9.58516313826156	11.0137873701720	13.0092252272610	15.6508428225614	19.0152393705936	23.1515050372346	28.0355613155012	33.5017546931224	39.1685582814053	44.4108034523686	48.4542957513352	50.6133588529980	50.5537766631646	48.4023398596779	44.6504278359193	39.9482925800163	34.9090595418386	29.9923506231958	25.4777543085344	21.4953942295147	18.0744629058078	15.1863928658583	12.7752301028093	10.7761243807106	9.12533169621440	7.76493020107540	6.64453599920227	5.72145165971671	4.96007678258414	4.33103262049131	3.81023284681484	3.37801036547554	3.01834481750534	2.71820212456308	2.46698146902235	2.25605836120343	2.07841039549267];
p2=[39.3938633172237	35.6687791915775	31.7317549876468	28.0077250759196	24.8394322059745	22.4509755576638	20.9636833066418	20.4337629774806	20.8855174581596	22.3279131984130	24.7518125476405	28.1102628240449	32.2905100317975	37.0956427559152	42.2564998785139	47.4765980826510	52.4849572524303	57.0699766691595	61.0918886313805	64.4819920836123	67.2314375830953	69.3730778108846	70.9629532959484	72.0659742952069	72.7468859234512	73.0655762559439	73.0752767659113	72.8224229592879	72.3473332630806	71.6851951200795	70.8670731568405	69.9207934084159	68.8716391847353	67.7428419156421	66.5558789592141	65.3306079620701	64.0852776779021	62.8364595229039	61.5989432544687	60.3856347913538];

a1=abs((R-r)./R)*100;
a2=abs((R-r2)./R)*100;
b1=abs(P-p);
b2=abs(P-p2);

figure
subplot(2,2,1)
H(1)=subplot(2,2,1);    
PPP=get(H(1),'pos');      
PPP(1)=PPP(1)-0.06;      
PPP(2)=PPP(2)-0.025;     
PPP(3)=PPP(3)+0.07;      
PPP(4)=PPP(4)+0.065;     
set(H(1),'pos',PPP)  

loglog(x,R,'-k*','LineWidth',1.5,'MarkerSize', 12)
hold on
loglog(x,r,'ok','LineWidth',1.5,'MarkerSize', 12)
hold on
loglog(x,r2,'xk','LineWidth',1.5,'MarkerSize', 12)

set(gca,'FontWeight','bold','FontSize',24,'FontName','Times New Roman');
h1=ylabel('App.resistivity(\Omega\cdotm)');
set(gca,'xticklabel','');
h2=text(1.2,80,'(a)');
set(h2,'FontWeight','bold','FontSize',28);
set(h2,'FontName','Times New Roman');
h3=legend('analytic','SG','MRS')
set(h3,'FontWeight','bold','FontSize',24);
set(h3,'FontName','Times New Roman');

set(gca, 'xTick', [1 10 100 1000 10000])
set(gca, 'yTick', [1 10 100])
set(gca,'TickLength',[0.02 0])
set(gca, 'LineWidth',1.5)

subplot(2,2,2)
H(2)=subplot(2,2,2);    
PPP=get(H(2),'pos');      
PPP(1)=PPP(1)-0.03;      
PPP(2)=PPP(2)-0.025;      
PPP(3)=PPP(3)+0.07;     
PPP(4)=PPP(4)+0.065;    
set(H(2),'pos',PPP) 
 
semilogx(x,P,'-k*','LineWidth',1.5,'MarkerSize', 12)
hold on
semilogx(x,p,'ok','LineWidth',1.5,'MarkerSize', 12)
hold on
semilogx(x,p2,'xk','LineWidth',1.5,'MarkerSize', 12)

set(gca,'FontWeight','bold','FontSize',24,'FontName','Times New Roman');
h1=ylabel('Phase(¡ã)');
set(gca,'xticklabel','');
h2=text(1.2,77,'(b)');
set(h2,'FontWeight','bold','FontSize',28);
set(h2,'FontName','Times New Roman');
axis([1 10000 20 80])
set(gca, 'xTick', [1 10 100 1000 10000])
set(gca, 'yTick', [20 40 60 80])
set(gca,'TickLength',[0.02 0])
set(gca, 'LineWidth',1.5)

subplot(2,2,3)
H(3)=subplot(2,2,3);    
PPP=get(H(3),'pos');      
PPP(1)=PPP(1)-0.06;      
PPP(2)=PPP(2)-0.01;      
PPP(3)=PPP(3)+0.07;      
PPP(4)=PPP(4)+0.065;     
set(H(3),'pos',PPP)  

semilogx(x,a1,'o k','LineWidth',1.5,'MarkerSize', 12)
hold on
semilogx(x,a2,'x k','LineWidth',1.5,'MarkerSize', 12)


set(gca,'FontWeight','bold','FontSize',24,'FontName','Times New Roman');
h2=text(1.2,4.75,'(c)');
set(h2,'FontWeight','bold','FontSize',28);
set(h2,'FontName','Times New Roman');

axis([1 10000 0 5])
set(gca, 'xTick', [1 10 100 1000 10000])
set(gca,'TickLength',[0.02 0])
set(gca, 'LineWidth',1.5)
ylabel('Rel.difference (%)')
xlabel('Period(s)')
h3=legend('SG & analytic', 'MRS & analytic')
set(h3,'FontWeight','bold','FontSize',24);
set(h3,'FontName','Times New Roman');

subplot(2,2,4)
H(2)=subplot(2,2,4);    
PPP=get(H(2),'pos');      
PPP(1)=PPP(1)-0.03;      
PPP(2)=PPP(2)-0.01;      
PPP(3)=PPP(3)+0.07;      
PPP(4)=PPP(4)+0.065;     
set(H(2),'pos',PPP)  

semilogx(x,b1,'o k','LineWidth',1.5,'MarkerSize', 12)
hold on
semilogx(x,b2,'x k','LineWidth',1.5,'MarkerSize', 12)


set(gca,'FontWeight','bold','FontSize',24,'FontName','Times New Roman');
h2=text(1.2,1.89,'(d)');
set(h2,'FontWeight','bold','FontSize',28);
set(h2,'FontName','Times New Roman');
axis([1 10000 0 2])
set(gca, 'xTick', [1 10 100 1000 10000])
set(gca,'TickLength',[0.02 0])
set(gca, 'LineWidth',1.5)
ylabel('Phase difference (¡ã)')
xlabel('Period(s)')
