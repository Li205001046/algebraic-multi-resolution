%%%%%%%%%%%%%%%%%%%%%%%
%%% Dublin Test Model 1
%%% Comparison of responses from SG, MRS, and MRG with the
%%% reference solution from Nam et al. (2007)
%%%%%%%%%%%%%%%%%%%%%%%
clc
clear all
x=[-37500,-32500,-27500,-22500,-17500,-12500,-7500,-2500,2500,7500,12500,17500,22500,27500,32500,37500];
x=x./1000;

%%% Nam et al. (2007)
R12=[97.8050000000000	96.6690000000000	94.4480000000000	90.6860000000000	84.2390000000000	74.2220000000000	63.3940000000000	53.1000000000000	52.0380000000000	59.7370000000000	68.1620000000000	76.1370000000000	82.0900000000000	86.5710000000000	90.0630000000000	92.5570000000000]';
R21=[104 106.260000000000	109.380000000000	112.990000000000	116.340000000000	115.870000000000	105.920000000000	67.3140000000000	53.6960000000000	71.0370000000000	77.7840000000000	82.6560000000000	88.1180000000000	93.5690000000000	97.5960000000000	99.7910000000000]';
P12=[45.0860000000000	45.1480000000000	45.2870000000000	45.5210000000000	45.8810000000000	46.2190000000000	46.4530000000000	46.1880000000000	46.3490000000000	46.9670000000000	46.9900000000000	46.8230000000000	46.4980000000000	46.2030000000000	45.9570000000000	45.7700000000000]';
P21=[-136.120000000000	-136.580000000000	-137.140000000000	-137.720000000000	-138.210000000000	-138.290000000000	-137.700000000000	-134.420000000000	-129.490000000000	-129.720000000000	-130.740000000000	-132.020000000000	-133.450000000000	-134.640000000000	-135.390000000000	-135.720000000000]';

%%% SG
r12=[100.022595450495	98.6510713988077	96.2843964873585	92.2549660493765	85.7716558311924	76.2862907947015	64.3145956379260	53.0686315811014		51.9063804657821	60.0955309419940	68.9900645461719	76.5274944709289	82.6292967435215	87.5414323433969	91.3992593843909	94.3216307761956]';
r21=[106.651112891102	109.014358207641	112.274734407785	116.141217575404	119.535590912421	120.060321696371	110.023505391241	66.8263350492604		52.3615519153012	71.2395473424652	77.4852973932945	82.6229000981555	89.1559494353906	95.5782688586369	100.101060540667	102.503164418929]';
p12=-[-45.6816853965975	-45.7548535041741	-45.8869121664676	-46.1051740084321	-46.4215928909620	-46.7848939233424	-46.9729723848431	-46.5520881084625		-46.6906292368548	-47.4749561890625	-47.5704818015730	-47.3583349697908	-47.0785913382249	-46.8109436732011	-46.5751119966293	-46.3779955383944]';
p21=-[135.594860837258	136.055147501237	136.618930934445	137.215862096813	137.703421555661	137.883231566532	137.339256282055	134.016523992958		128.901401864249	129.078617964253	129.997028714638	131.372852724655	132.934282819679	134.212913230618	134.971124686637	135.292925523646]';

%%% MRS
c12=[100.028281701035	98.6579281053130	96.2925154487026	92.2647088318214	85.7836156747451	76.3012231950175	64.3330225371171	53.0895148299075		51.9270361923241	60.1142651336503	69.0056886061900	76.5390010256505	82.6354489984348	87.5410894478880	91.3920002706770	94.3077706846200]';
c21=[106.684462716389	109.053608173653	112.318393152518	116.186498004781	119.577936283483	120.094561686138	110.043902730385	66.8286007448873		52.3380378478083	71.1816211873330	77.4054785811426	82.5247979014820	89.0426798296255	95.4563157681700	99.9789718159301	102.388568015574]';
d12=-[-45.6988077749578	-45.7741599627035	-45.9082223779506	-46.1281436675567	-46.4457564725414	-46.8099805113682	-46.9988581127127	-46.5779950381163		-46.7144290420591	-47.4951210487514	-47.5856542871529	-47.3679608914524	-47.0825682041300	-46.8095723469878	-46.5692973080130	-46.3690211318403]';
d21=-[135.569579095890	136.022720214380	136.579259337849	137.169999034455	137.653597691270	137.832852822310	137.293349516284	133.986186946571		128.905051153390	129.101304598727	130.030139397381	131.414037667373	132.980945161267	134.260957768098	135.016102551328	135.331660681114]';

%%% MRG
e12=[99.7441150339061	98.3918784913966	96.0396522988631	92.0124934397891	85.5106939726259	75.9827461251171	63.9554080958382	52.6669894695456		51.4898928596563	59.6747514011463	68.5677934824742	76.1040768454286	82.2061768103143	87.1208433705501	90.9824219814372	93.9081706230530]';
e21=[106.320412717411	108.716389255126	112.019005516963	115.930678966992	119.357800633271	119.882734319091	109.792108058873	66.5112284857807		51.9463761317938	70.6650387764261	76.8880795492862	82.0429896070638	88.6128317556357	95.0804853248113	99.6418351922275	102.069409683997]';
f12=-[-44.6067081038787	-44.6786505386214	-44.8124332004761	-45.0384714127850	-45.3735871422005	-45.7736578601599	-46.0242087764655	-45.6842830483249		-45.8359002551114	-46.5671982415931	-46.6196258292283	-46.3785571510811	-46.0784411150319	-45.7955575523884	-45.5484665733022	-45.3434161523385]';
f21=-[136.666043557686	137.138138780125	137.715748412283	138.325997426846	138.822186016338	139.001050160268	138.436636717575	135.019106158122		129.737328443187	129.904758628986	130.849631190925	132.269963639210	133.882662295102	135.204284331574	135.990395405518	136.327613573635]';

p21=p21+360;
P21=P21+360;
d21=d21+360;
f21=f21+360;

a11=abs((R12-r12)./R12)*100;
a12=abs((R21-r21)./R21)*100;
a21=abs((R12-c12)./R12)*100;
a22=abs((R21-c21)./R21)*100;
a31=abs((R12-e12)./R12)*100;
a32=abs((R21-e21)./R21)*100;

b11=abs((P12-p12));
b12=abs((P21-p21));
b21=abs((P12-d12));
b22=abs((P21-d21));
b31=abs((P12-f12));
b32=abs((P21-f21));

figure(1)
set(gca,'LooseInset',get(gca,'TightInset'))
subplot(2,3,1)
H(1)=subplot(2,3,1);    
PPP=get(H(1),'pos');      
PPP(1)=PPP(1)-0.06;      
PPP(2)=PPP(2)-0.015;     
PPP(3)=PPP(3)+0.02;     
PPP(4)=PPP(4)+0.04;     
set(H(1),'pos',PPP)  

semilogy(x,R12,'-*r','LineWidth',1.5,'MarkerSize', 15)
hold on
semilogy(x,r12,'o r','LineWidth',1.5,'MarkerSize', 15)
hold on
semilogy(x,c12,'s r','LineWidth',1.5,'MarkerSize', 15)
hold on
semilogy(x,e12,'x r','LineWidth',1.5,'MarkerSize', 15)

set(gca,'FontWeight','bold','FontSize',28,'FontName','Times New Roman');
h1=ylabel('App.resistivity(\Omega\cdotm)');
set(gca,'xticklabel','');
h2=text(-39,800,'(a) XY');
set(h2,'FontWeight','bold','FontSize',28);
set(h2,'FontName','Times New Roman');
h3=legend('Nam et al. (2007)','SG','MRS','MRG')
set(h3,'FontWeight','bold','FontSize',18);
set(h3,'FontName','Times New Roman');

axis([-40 40 10 1000])
set(gca, 'yTick', [10^1 10^2 10^3])
set(gca,'TickLength',[0.03 0])
set(gca, 'LineWidth',2)


subplot(2,3,2)
H(2)=subplot(2,3,2);    
PPP=get(H(2),'pos');      
PPP(1)=PPP(1)-0.03;      
PPP(2)=PPP(2)-0.015;     
PPP(3)=PPP(3)+0.025;     
PPP(4)=PPP(4)+0.04;      
set(H(2),'pos',PPP)  

semilogy(x,R21,'-*b','LineWidth',1.5,'MarkerSize', 15)
hold on
semilogy(x,r21,'o b','LineWidth',1.5,'MarkerSize', 15)
hold on
semilogy(x,c21,'s b','LineWidth',1.5,'MarkerSize', 15)
hold on
semilogy(x,e21,'x b','LineWidth',1.5,'MarkerSize', 15)

set(gca,'FontWeight','bold','FontSize',28,'FontName','Times New Roman');
h1=ylabel('App.resistivity(\Omega\cdotm)');
h2=text(-39,800,'(b) YX');
set(h2,'FontWeight','bold','FontSize',28,'FontName','Times New Roman');

set(gca,'xticklabel','');
axis([-40 40 10 1000])
set(gca, 'yTick', [10 100 1000])
set(gca,'TickLength',[0.03 0])
set(gca, 'LineWidth',2)

subplot(2,3,3)
H(3)=subplot(2,3,3);    
PPP=get(H(3),'pos');      
PPP(1)=PPP(1)+0.01;      
PPP(2)=PPP(2)-0.015;      
PPP(3)=PPP(3)+0.02;      
PPP(4)=PPP(4)+0.04;      
set(H(3),'pos',PPP)  

plot(x,a11,'o r','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,a21,'+ r','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,a31,'x r','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,a12,'s b','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,a22,'^ b','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,a32,'* b','LineWidth',1.5,'MarkerSize', 15)

h1=ylabel('Rel.difference (%)');
set(gca,'FontWeight','bold','FontSize',28,'FontName','Times New Roman');
h3=legend('XY of SG','XY of MRS','XY of MRG','YX of SG','YX of MRS','YX of MRG')
set(h3,'FontWeight','bold','FontSize',18);
set(h3,'FontName','Times New Roman');

h2=text(-39,3.8,'(c)');
set(h2,'FontWeight','bold','FontSize',28,'FontName','Times New Roman');

set(gca,'xticklabel','');
set(gca,'TickLength',[0.03 0])
set(gca, 'LineWidth',2)
axis([-40 40 0 4])
set(gca, 'yTick', [0 1 2 3 4])

subplot(2,3,4)
H(4)=subplot(2,3,4);
PPP=get(H(4),'pos'); 
PPP(1)=PPP(1)-0.06;      
PPP(2)=PPP(2)+0.015;     
PPP(3)=PPP(3)+0.02;      
PPP(4)=PPP(4)+0.03;      
set(H(4),'pos',PPP)  

plot(x,P12,'-*r','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,p12,'o r','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,d12,'s r','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,f12,'x r','LineWidth',1.5,'MarkerSize', 15)

h1=ylabel('Phase(\circ)');
h2=xlabel('y(km)');
axis([-40 40 30 60])
set(gca, 'yTick', [30 40 50 60])

set(gca,'FontWeight','bold','FontSize',28,'FontName','Times New Roman');
h3=text(-39,58.5,'(d) XY');
set(h3,'FontWeight','bold','FontSize',28);
set(h3,'FontName','Times New Roman');

set(gca,'TickLength',[0.03 0])
set(gca, 'LineWidth',2)

subplot(2,3,5)
H(5)=subplot(2,3,5);    
PPP=get(H(5),'pos');      
PPP(1)=PPP(1)-0.03;      
PPP(2)=PPP(2)+0.015;     
PPP(3)=PPP(3)+0.025;     
PPP(4)=PPP(4)+0.03;      
set(H(5),'pos',PPP) 

plot(x,P21,'-*b','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,p21,'o b','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,d21,'s b','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,f21,'x b','LineWidth',1.5,'MarkerSize', 15)

h1=ylabel('Phase(\circ)');
h2=xlabel('y(km)');
axis([-40 40 200 260])
set(gca, 'yTick', [200 220 240 260])

set(gca,'FontWeight','bold','FontSize',28,'FontName','Times New Roman');
h3=text(-39,257,'(e) YX');
set(h3,'FontWeight','bold','FontSize',28);
set(h3,'FontName','Times New Roman');

set(gca,'TickLength',[0.03 0])
set(gca, 'LineWidth',2)

subplot(2,3,6)
H(6)=subplot(2,3,6);    
PPP=get(H(6),'pos');      
PPP(1)=PPP(1)+0.01;      
PPP(2)=PPP(2)+0.015;     
PPP(3)=PPP(3)+0.02;      
PPP(4)=PPP(4)+0.03;      
set(H(6),'pos',PPP) 

plot(x,b11,'o r','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,b21,'+ r','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,b31,'x r','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,b12,'s b','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,b22,'^ b','LineWidth',1.5,'MarkerSize', 15)
hold on
plot(x,b32,'* b','LineWidth',1.5,'MarkerSize', 15)

h1=ylabel('Phase difference (бу)');
h2=xlabel('y(km)');
set(gca,'FontWeight','bold','FontSize',28,'FontName','Times New Roman');

h2=text(-39,0.948,'(f)');
set(h2,'FontWeight','bold','FontSize',28,'FontName','Times New Roman');

set(gca,'TickLength',[0.03 0])
set(gca, 'LineWidth',3)
axis([-40 40 0 1])
set(gca, 'yTick', [0 0.2 0.4 0.6 0.8 1])